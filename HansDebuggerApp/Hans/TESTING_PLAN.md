# üß™ –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∏–∞–º–µ—Ç—Ä–∞ –ø—É—á–∫–∞

## üîÑ –¢–µ–∫—É—â–µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ

**–ò–ó–ú–ï–ù–ï–ù–û:** –í–º–µ—Å—Ç–æ `UDM_AddPoint2D` —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `UDM_AddPolyline3D`

### –ü—Ä–∏—á–∏–Ω–∞

`UDM_AddPolyline3D` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç Z –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—É –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤.

–í Java –∫–æ–¥–µ –≤—Å–µ —Ç–æ—á–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `UDM_AddPolyline3D`, –∞ `UDM_AddPoint2D` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è SkyWriting –∑–∞–¥–µ—Ä–∂–µ–∫.

### –ö–æ–¥ –¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è

```csharp
// –°—Ç–∞—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
UDM_AddPoint2D(point, dwellTimeMs, 0);
```

### –ö–æ–¥ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

```csharp
// –ù–æ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
structUdmPos[] polyline = new structUdmPos[] { point };
UDM_AddPolyline3D(polyline, 1, 0);  // 1 —Ç–æ—á–∫–∞, layerIndex = 0

// –í—Ä–µ–º—è —ç–∫—Å–ø–æ–∑–∏—Ü–∏–∏ —á–µ—Ä–µ–∑ UDM_AddPoint2D (–±–µ–∑ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è)
if (dwellTimeMs > 0)
{
    structUdmPos dwellPoint = new structUdmPos { x = x, y = y, z = zCoord, a = 0 };
    UDM_AddPoint2D(dwellPoint, dwellTimeMs, 0);
}
```

---

## ‚úÖ –¢–µ—Å—Ç 1: –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### –ó–∞–ø—É—Å—Ç–∏—Ç–µ

```csharp
RunDiameterTests.RunQuick(80.0, 200f);
```

### –ü—Ä–æ–∂–≥–∏—Ç–µ —Ç–æ—á–∫—É –∏ –∏–∑–º–µ—Ä—å—Ç–µ –¥–∏–∞–º–µ—Ç—Ä

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** ~80 –º–∫–º ¬± 10%

**–ï—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–∏:**
- ‚úÖ **75-85 –º–∫–º** ‚Üí UDM_AddPolyline3D —Ä–∞–±–æ—Ç–∞–µ—Ç! –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ.
- ‚ö†Ô∏è **~50-60 –º–∫–º** ‚Üí –ü—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –¢–µ—Å—Ç—É 2.
- ‚ö†Ô∏è **–î—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** ‚Üí –°–æ–æ–±—â–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

## üîç –¢–µ—Å—Ç 2: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–æ–≤

–ï—Å–ª–∏ –¢–µ—Å—Ç 1 –Ω–µ –¥–∞–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, –∑–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É:

```csharp
SimpleDebugTest.TestCalculations();
```

–≠—Ç–æ –ø–æ–∫–∞–∂–µ—Ç:
- –ü–æ—à–∞–≥–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç Z –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–∏–∞–º–µ—Ç—Ä–∞
- –û–±—Ä–∞—Ç–Ω—ã–π —Ä–∞—Å—á–µ—Ç (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞)
- –í—Å–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

**–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –≤—ã–≤–æ–¥ –∫–æ–Ω—Å–æ–ª–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ —Ñ–∞–π–ª** - —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –ø—Ä–æ–±–ª–µ–º—É.

### –ß—Ç–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å

1. **–û–±—Ä–∞—Ç–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—ã–º?**
   - ‚úÖ –î–∞ ‚Üí –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Å–∫–∞–Ω–µ—Ä–µ –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö
   - ‚ùå –ù–µ—Ç ‚Üí –û—à–∏–±–∫–∞ –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–µ

2. **–ó–Ω–∞—á–µ–Ω–∏—è lensTravelMicron —Ä–∞–∑—É–º–Ω—ã–µ?**
   - –î–ª—è 80 –º–∫–º: ~450 –º–∫–º
   - –î–ª—è 100 –º–∫–º: ~780 –º–∫–º
   - –î–ª—è 150 –º–∫–º: ~1600 –º–∫–º

3. **Z –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ —Ä–∞–∑—É–º–Ω—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö?**
   - –î–æ–ª–∂–Ω—ã –±—ã—Ç—å: 0.001 - 0.5 –º–º
   - –ï—Å–ª–∏ —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–µ (<0.001) –∏–ª–∏ –±–æ–ª—å—à–∏–µ (>1.0) ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ –ø–æ–ª–∏–Ω–æ–º–µ

---

## üìä –¢–µ—Å—Ç 3: –ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏

–ï—Å–ª–∏ UDM_AddPolyline3D —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –µ—Å—Ç—å –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è, —Å–æ–±–µ—Ä–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ:

```csharp
// –ü—Ä–æ–∂–≥–∏—Ç–µ 4 —Ç–æ—á–∫–∏
RunDiameterTests.RunQuick(80.0, 200f);
RunDiameterTests.RunQuick(100.0, 200f);
RunDiameterTests.RunQuick(150.0, 200f);
RunDiameterTests.RunQuick(200.0, 200f);
```

**–ò–∑–º–µ—Ä—å—Ç–µ –≤—Å–µ 4 –¥–∏–∞–º–µ—Ç—Ä–∞**, –∑–∞—Ç–µ–º:

```csharp
var config = RunDiameterTests.LoadConfiguration();

var measurements = new List<CalibrationHelper.Measurement>
{
    new CalibrationHelper.Measurement { RequestedDiameterMicron = 80.0, MeasuredDiameterMicron = ??? },
    new CalibrationHelper.Measurement { RequestedDiameterMicron = 100.0, MeasuredDiameterMicron = ??? },
    new CalibrationHelper.Measurement { RequestedDiameterMicron = 150.0, MeasuredDiameterMicron = ??? },
    new CalibrationHelper.Measurement { RequestedDiameterMicron = 200.0, MeasuredDiameterMicron = ??? }
};

CalibrationHelper.AnalyzeAndSuggestCorrection(config, measurements);
```

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤—ã–¥–∞—Å—Ç:
- –°—Ä–µ–¥–Ω–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –æ—à–∏–±–∫–∏
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—É—é –∫–æ—Ä—Ä–µ–∫—Ü–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ì–æ—Ç–æ–≤—É—é JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üîß –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –í—Å–µ –¥–∏–∞–º–µ—Ç—Ä—ã ~50 –º–∫–º (–∫–∞–∫ –¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

**–ü—Ä–∏—á–∏–Ω–∞:** Z –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –≤—Å–µ –µ—â–µ –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `enableZCorrection = true` –≤ –∫–æ–Ω—Ñ–∏–≥–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `enableDiameterChange = true` –≤ –∫–æ–Ω—Ñ–∏–≥–µ
3. –í–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å `UDM_Set3dCorrectionPara` (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –≤ –∫–æ–¥–µ)

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –î–∏–∞–º–µ—Ç—Ä—ã –º–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—ã—Ö –Ω–∞ 20-30%

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–∞—Ä–∞–º–µ—Ç—Ä—ã beamConfig –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ

**–†–µ—à–µ–Ω–∏–µ:**
- –£–≤–µ–ª–∏—á–∏—Ç—å `rayleighLengthMicron`
- –ò–õ–ò —É–º–µ–Ω—å—à–∏—Ç—å `minBeamDiameterMicron`

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `CalibrationHelper` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞.

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –î–∏–∞–º–µ—Ç—Ä—ã –±–æ–ª—å—à–µ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—ã—Ö

**–ü—Ä–∏—á–∏–Ω–∞:** –û–±—Ä–∞—Ç–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–≤—ã—à–µ–Ω—ã

**–†–µ—à–µ–Ω–∏–µ:**
- –£–º–µ–Ω—å—à–∏—Ç—å `rayleighLengthMicron`
- –ò–õ–ò —É–≤–µ–ª–∏—á–∏—Ç—å `minBeamDiameterMicron`

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ù–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–ª–∏–Ω–æ–º Z-–∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–ª–∏–±—Ä–æ–≤–∫—É –≤ Hans Laser Marker
- –í–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–æ –æ—Ç–∫–∞–ª–∏–±—Ä–æ–≤–∞—Ç—å –æ—Å—å Z —Ñ–∏–∑–∏—á–µ—Å–∫–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã `afactor`, `bfactor`, `cfactor`

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç

- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –¢–µ—Å—Ç 1: `RunDiameterTests.RunQuick(80.0, 200f)`
- [ ] –ü—Ä–æ–∂–µ—á—å —Ç–æ—á–∫—É –∏ –∏–∑–º–µ—Ä–∏—Ç—å –¥–∏–∞–º–µ—Ç—Ä
- [ ] –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç—å –¢–µ—Å—Ç 2: `SimpleDebugTest.TestCalculations()`
- [ ] –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–≤–æ–¥ –∫–æ–Ω—Å–æ–ª–∏
- [ ] –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç—å –¢–µ—Å—Ç 3 (–Ω–∞–±–æ—Ä –∏–∑ 4 —Ç–æ—á–µ–∫)
- [ ] –ò–∑–º–µ—Ä–∏—Ç—å –≤—Å–µ –¥–∏–∞–º–µ—Ç—Ä—ã
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–∞–ª–∏–±—Ä–æ–≤–∫—É: `CalibrationHelper.AnalyzeAndSuggestCorrection()`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `scanator_config_test.json` —Å –Ω–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- [ ] –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –¢–µ—Å—Ç 1 –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

---

## üí° –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **UDM_AddPolyline3D** - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–± –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ—á–µ–∫ –≤ Java –∫–æ–¥–µ
2. **UDM_AddPoint2D** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–¥–µ—Ä–∂–µ–∫ (dwell time)
3. –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—Å–µ –µ—â–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, –ø—Ä–æ–±–ª–µ–º–∞ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –≤:
   - –ü–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (minBeamDiameter, rayleighLength)
   - –ü–æ–ª–∏–Ω–æ–º–µ Z-–∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ (afactor, bfactor, cfactor)
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–∫–∞–Ω–µ—Ä–∞ Hans

4. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥** `SimpleDebugTest` –ø–æ–∫–∞–∂–µ—Ç —Ç–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ

---

**–ù–∞—á–Ω–∏—Ç–µ —Å –¢–µ—Å—Ç–∞ 1** –∏ —Å–æ–æ–±—â–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç!
