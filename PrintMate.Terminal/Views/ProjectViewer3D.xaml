<UserControl x:Class="PrintMate.Terminal.Views.Pages.ProjectViewer3D"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:controls="clr-namespace:PrintMate.Terminal.Controls"
             xmlns:prism="http://prismlibrary.com/"
             xmlns:views="clr-namespace:PrintMate.Terminal.Views"
             xmlns:componentsViews="clr-namespace:PrintMate.Terminal.Views.ComponentsViews"
             xmlns:hc="https://handyorg.github.io/handycontrol"
             xmlns:converters="clr-namespace:PrintMate.Terminal.Converters"
             prism:ViewModelLocator.AutoWireViewModel="True"
             ClipToBounds="True"
             mc:Ignorable="d"
             d:DesignHeight="1066" d:DesignWidth="1406"
             Background="Black"
             Loaded="UserControl_Loaded">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <converters:PercentToWidthConverter x:Key="PercentToWidthConverter"/>
    </UserControl.Resources>
    <Grid>
        <Canvas x:Name="RootCanvas">

            <!-- DX11 Viewport - основной 3D визуализатор --><!--
            <controls:DX11ViewportControl Grid.Column="0" x:Name="Viewport"
                                          Width="{Binding ElementName=RootCanvas, Path=ActualWidth}"
                                          Height="{Binding ElementName=RootCanvas, Path=ActualHeight}"
                                          ShowInfo="False"
                                          Background="Black"
                                          Visibility="Visible"/>-->

            <!-- 2D LayerCanvas - скрыт, используется для превью -->
            
            <views:LayerCanvas x:Name="LayerCanvasFullscreen"
                               Width="{Binding ElementName=RootCanvas, Path=ActualWidth}"
                               Height="{Binding ElementName=RootCanvas, Path=ActualHeight}"
                               Visibility="Visible"/>



            <!--<Image Visibility="{Binding ShadowVisibility}" IsHitTestVisible="False" Source="/images/gradient2.png" HorizontalAlignment="Left" Width="1500" Opacity="1"/>-->
            <!--<Image Visibility="{Binding ShadowVisibility}" IsHitTestVisible="False" Source="/images/gradient.png" HorizontalAlignment="Left" Width="1500" Opacity="1"/>
            <Image Visibility="{Binding ShadowVisibility}" IsHitTestVisible="False" Source="/images/gradient.png" HorizontalAlignment="Left" Width="1500" Opacity="1"/>-->
            <!--<Image Visibility="{Binding ShadowVisibility}" IsHitTestVisible="False" Source="/images/left_gradient.png" HorizontalAlignment="Left" Width="1500" Opacity="0.5"/>
            <Image Visibility="{Binding ShadowVisibility}" IsHitTestVisible="False" Source="/images/right_gradient.png" HorizontalAlignment="Right" Width="1500" Opacity="0.2"/>-->


            <Border x:Name="CameraBorder" Canvas.Bottom="50" Canvas.Right="360" Margin="10" Width="250" Height="250" BorderBrush="Gray" BorderThickness="2" MouseDown="CameraClickCallback">
                <Image x:Name="CameraSource" Stretch="Fill"/>
            </Border>

            <Image  IsHitTestVisible="False" Source="/images/gradient2.png" HorizontalAlignment="Left" Width="1500" Opacity="1"/>
            <Image  IsHitTestVisible="False" Source="/images/gradient.png" HorizontalAlignment="Left" Width="1500" Opacity="1"/>


            <StackPanel Margin="50">
                <TextBlock Text="Режим печати" Foreground="White" FontWeight="Bold" FontSize="40" Margin="0"/>
                <TextBlock Text="{Binding ProjectName}" Foreground="Gray" FontWeight="Bold" FontSize="30" Margin="0"/>
            </StackPanel>

            <!--<Border Width="310" Height="385"
                    Canvas.Left="0"
                    Canvas.Bottom="0"
                    Margin="20"
                    BorderBrush="#181818" BorderThickness="0"
                    ClipToBounds="True">
                <componentsViews:Container Width="300" Height="300" Title="2D превью" TitleSize="15">
                    <views:LayerCanvas x:Name="LayerCanvasFullscreen" Width="283" Height="245" />
                </componentsViews:Container>
            </Border>-->

            <Border x:Name="RightMenu" Canvas.Right="0" Canvas.Top="0" Width="300" Background="Transparent" CornerRadius="0" HorizontalAlignment="Left" Canvas.Left="1080" VerticalAlignment="Center">
                <Border.Effect>
                    <DropShadowEffect Color="Black" BlurRadius="90" Direction="6"/>
                </Border.Effect>
                <StackPanel Panel.ZIndex="9999" Margin="0 50 0 0" Cursor="">

                    <componentsViews:Container Title="Автоматический процесс" TitleSize="15">
                        <Button Visibility="{Binding StartPrintVisibility}" Command="{Binding StartPrintCommand}" IsEnabled="{Binding StartPrintButtonIsEnabled}" FontWeight="Bold" FontSize="15" Height="50" Content="Запустить" HorizontalAlignment="Stretch" Margin="5" Style="{StaticResource ButtonSuccess}"/>
                        <Button Visibility="{Binding ContinuePrintVisibility}" Command="{Binding ContinuePrintCommand}" FontWeight="Bold" FontSize="15" Height="50" Content="Продолжить" HorizontalAlignment="Stretch" Margin="5" Style="{StaticResource ButtonSuccess}"/>
                        <Button Visibility="{Binding AbortPrintVisibility}" Command="{Binding StopPrintCommand}" FontWeight="Bold" FontSize="15" Height="50" Content="Прервать" HorizontalAlignment="Stretch" Margin="5" Style="{StaticResource ButtonDanger}"/>
                        <Button Visibility="{Binding PausePrintVisibility}" Command="{Binding PausePrintCommand}" FontWeight="Bold" FontSize="15" Height="50" Content="Пауза" HorizontalAlignment="Stretch" Margin="5" Style="{StaticResource ButtonPrimary}"/>
                    </componentsViews:Container>

                    <componentsViews:Container Title="Ручное управление" TitleSize="15" Margin="0 20 0 0" Cursor="">
                        <TextBlock HorizontalAlignment="Left" Foreground="White" FontWeight="Bold" FontSize="10" Margin="8 0 0 0">Номер слоя</TextBlock>
                        <Button FontWeight="Bold" FontSize="15" Height="30" HorizontalAlignment="Stretch" Foreground="Black" Background="White" Command="{Binding SelectLayerForSingleMarkCommand}" Content="{Binding SelectLayerForSingleMark}" Margin="5" />

                        <hc:ProgressButton Height="50" Command="{Binding StartSingleLayerMarkCommand}" FontWeight="Bold" FontSize="15" Visibility="{Binding StartSingleLayerMarkVisibility}" IsEnabled="{Binding StartSingleLayerMarkButtonIsEnabled}" Style="{StaticResource ProgressButtonSuccess}" IsChecked="True" Progress="{Binding SingleLayerMarkProgress}" HorizontalAlignment="Stretch" Content="Запустить" Margin="5"/>
                        <Button FontWeight="Bold" FontSize="15" Height="50" Visibility="{Binding AbortSingleLayerMarkVisibility}" HorizontalAlignment="Stretch"  Command="{Binding StopSingleLayerMarkCommand}" Content="Стоп" Margin="5" Style="{StaticResource ButtonDanger}"/>
                        <Button FontWeight="Bold" FontSize="15" Height="50" IsEnabled="{Binding StartPowderApplyIsEnabled}" Command="{Binding StartApplyPowderCommand}" HorizontalAlignment="Stretch" Content="Нанести порошок" Margin="5" />
                    </componentsViews:Container>

                    <componentsViews:Container Title="Управление слоями" TitleSize="15" Margin="0 20 0 0" Padding="15">
                        <componentsViews:ParameterAndValueView Margin="5" ParameterName="Текущий слой" ParameterValue="{Binding CurrentLayer}"/>
                        <componentsViews:ParameterAndValueView Margin="5" ParameterName="Всего слоев" ParameterValue="{Binding MaxLayers}"/>

                        <Slider Margin="10" Foreground="OrangeRed" IsSnapToTickEnabled="True" Value="{Binding CurrentLayer}" Minimum="1" Maximum="{Binding MaxLayers}"/>
                        <WrapPanel>
                            <CheckBox FontWeight="Bold" VerticalAlignment="Center" Content="Онлайн" IsChecked="True" Foreground="White" />
                        </WrapPanel>
                        <TextBlock VerticalAlignment="Center" HorizontalAlignment="Left" Foreground="Gray" FontWeight="Regular" FontSize="10" Margin="8 0 0 0">* Автоматическое отображение геометрии текущего слоя</TextBlock>
                    </componentsViews:Container>

                    <componentsViews:Container Title="Детали" TitleSize="15" Margin="0 20 0 0" Padding="15">
                        <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="White" Margin="50">Блок в доработке</TextBlock>
                    </componentsViews:Container>
                </StackPanel>
            </Border>

            <WrapPanel x:Name="ProgressPanel" Canvas.Bottom="0" Canvas.Left="200">
                <StackPanel Margin="0 0 50 0">
                    <hc:WaveProgressBar BorderBrush="#454545" BorderThickness="2" Value="{Binding LayerProgress}" FontWeight="Black" Foreground="White" Background="#1f1f1f" FontSize="20" Margin="0 0,0,0" WaveThickness="4" WaveStroke="#ff4e02">
                        <hc:WaveProgressBar.WaveFill>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#ff8e5e" Offset="0"/>
                                <GradientStop Color="#ff560e" Offset="1"/>
                            </LinearGradientBrush>
                        </hc:WaveProgressBar.WaveFill>
                    </hc:WaveProgressBar>
                    <TextBlock Text="Прогресс выполнения слоя" Foreground="White" HorizontalAlignment="Center"/>
                </StackPanel>
                <StackPanel>
                    <hc:WaveProgressBar BorderBrush="#454545" BorderThickness="2" HorizontalAlignment="Center" Value="{Binding PrintProgress}" FontWeight="Black" Background="#1f1f1f" Foreground="White" FontSize="20" Margin="0,0,0,0" WaveThickness="4" WaveStroke="#ff4e02">
                        <hc:WaveProgressBar.WaveFill>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#ff8e5e" Offset="0"/>
                                <GradientStop Color="#ff560e" Offset="1"/>
                            </LinearGradientBrush>
                        </hc:WaveProgressBar.WaveFill>
                    </hc:WaveProgressBar>
                    <TextBlock Text="Прогресс выполнения проекта" Foreground="White" HorizontalAlignment="Center"/>
                </StackPanel>
            </WrapPanel>
        </Canvas>
    </Grid>

</UserControl>
